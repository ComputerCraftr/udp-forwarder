[target.x86_64-unknown-linux-musl]
linker = "clang"
rustflags = [
"-C","target-cpu=native",
"-C","relocation-model=pic",        # PIE codegen
"-C","target-feature=+crt-static",  # musl libc static
"-C","link-arg=-fuse-ld=lld",
"-C","link-arg=-static-pie",
"-C","link-arg=-Wl,--eh-frame-hdr",

# force static archives; order matters
"-C","link-arg=-Wl,-Bstatic",
"-C","link-arg=-Wl,--start-group",
"-C","link-arg=-lunwind",
"-C","link-arg=-lgcc_eh",
"-C","link-arg=-Wl,--end-group",
# leave Bdynamic off so nothing shared is picked after the group
]

[target.aarch64-unknown-linux-musl]
linker = "clang"
rustflags = [
"-C","target-cpu=native",
"-C","relocation-model=pic",        # PIE codegen
"-C","target-feature=+crt-static",  # musl libc static
"-C","link-arg=-fuse-ld=lld",
"-C","link-arg=-static-pie",
"-C","link-arg=-Wl,--eh-frame-hdr",

# force static archives; order matters
"-C","link-arg=-Wl,-Bstatic",
"-C","link-arg=-Wl,--start-group",
"-C","link-arg=-lunwind",
"-C","link-arg=-lgcc_eh",
"-C","link-arg=-Wl,--end-group",
# leave Bdynamic off so nothing shared is picked after the group
]
